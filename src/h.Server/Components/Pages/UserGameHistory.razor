@attribute [Route(PageRoutes.User.UserGameHistory)]
@rendermode InteractiveWebAssembly
@using h.Client.Services

<PageTitle>Hry hráče @currentUser?.Username</PageTitle>

<div class="userbanner">
    <div class="userbox sheet">
        <img src="/IMG/pfps/pfp-blue.svg" alt="">
        <p>evzen.rozinka</p>
    </div>
</div>

<div class="sheet game-history">
    <h2 class="blue">Historie her</h2>
    <table class="game-history-list">
        <thead class="game-history-head">
            <tr>
                <th>ID hry</th>
                <th>Datum</th>
                <th>Protivník</th>
                <th>Symbol</th>
                <th>Vyhrál</th>
                <th>Zobrazit hru</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var gameRecord in currentUser!.UserToFinishedRankedGames.Reverse())
            {
                var gameId = gameRecord.FinishedRankedGameId!;
                var opponentName = opponentsInGames?[gameRecord.FinishedRankedGame!.GetOpponentUserId(currentUser!.Uuid)];
                var playerSymbolIcon = ResourceHelper.GetSymbolSrc(gameRecord.FinishedRankedGame!.GetPlayerSymbol(currentUser.Uuid));
                bool didWin = gameRecord.FinishedRankedGame!.DidWin(currentUser!.Uuid);

                <tr>
                    <td>@gameId</td>
                    <td>@(gameRecord.FinishedRankedGame!.PlayedAt.ToShortDateString())</td>
                    <td>@opponentName</td>
                    <td>
                        <img src="@playerSymbolIcon" class="player-icon" />
                    </td>
                    @if (didWin)
                    {
                        <td>Tento hráč</td>
                    }
                    else
                    {
                        <td>Protivník</td>
                    }
                    <td>
                        <button class="view" @onclick="HandleOpenGameArchive">
                            <img src="/IMG/icons/view.svg" alt="">
                        </button>
                    </td>
                </tr>
            }        
        </tbody>
    </table>
</div>